<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <title>유니폼 구성기</title>
    <link rel="stylesheet" href="styles-tokens.css">
    <link rel="stylesheet" href="styles.css?v=right-layout">
    <link rel="stylesheet" href="accessibility.css">
</head>
<body>
    <!-- Skip to main content link for screen readers -->
    <a href="#main-content" class="skip-link" data-i18n="accessibility.skipToMain">메인 콘텐츠로 건너뛰기</a>

    <!-- Live region for screen reader announcements -->
    <div id="screen-reader-announcements" class="sr-only" aria-live="polite" aria-atomic="true"></div>
    <div id="screen-reader-alerts" class="sr-only" aria-live="assertive" aria-atomic="true"></div>

    <div class="app-container" role="application" data-i18n-aria="accessibility.appContainer" aria-label="3D 유니폼 구성기 응용프로그램">
        <main id="main-content" role="main" data-i18n-aria="accessibility.mainContent" aria-label="3D 유니폼 미리보기 및 컨트롤">
        <section class="viewer-panel" data-i18n-aria="accessibility.previewViewport" aria-label="3D 미리보기 뷰포트">
            <div id="three-container" role="img" data-i18n-aria="accessibility.threeDPreview" aria-label="3D 유니폼 미리보기 - 화살표 키로 회전, +/- 키로 확대/축소" tabindex="0"></div>
            
            <!-- Reset button (bottom left) -->
            <div class="reset-button-container">
                <button id="reset-view-btn" class="reset-view-btn"
                        aria-label="Reset 3D view to default state"
                        title="Reset view to default state">⟲</button>
            </div>
            
            <!-- FOV slider overlay -->
            <div id="fov-slider-overlay" class="fov-slider-overlay" style="display: none;" role="dialog" aria-label="Field of View Controls">
                <div class="fov-slider-container">
                    <label for="fov-slider">Field of View:</label>
                    <input type="range" id="fov-slider" min="10" max="50" step="1" value="35"
                           aria-label="Field of view angle in degrees"
                           aria-describedby="fov-value">
                    <span id="fov-value" aria-live="polite">35°</span>
                </div>
            </div>
            
            <!-- Scale slider overlay -->
            <div id="scale-slider-overlay" class="scale-slider-overlay" style="display: none;" role="dialog" aria-label="Layer Property Controls">
                <div class="scale-slider-container">
                    <label for="scale-slider" data-i18n="controls.scale">크기:</label>
                    <input type="range" id="scale-slider" min="0.1" max="3" step="0.1" value="1"
                           aria-label="Layer scale from 0.1 to 3.0"
                           aria-describedby="scale-value">
                    <span id="scale-value" aria-live="polite">1.0</span>
                </div>

                <div class="section-separator"></div>

                <div class="rotate-flip-container">
                    <div class="rotate-slider-container">
                        <label for="rotate-slider" data-i18n="controls.rotation">회전:</label>
                        <input type="range" id="rotate-slider" min="0" max="359" step="1" value="0"
                               aria-label="Layer rotation angle in degrees"
                               aria-describedby="rotate-value">
                        <span id="rotate-value" aria-live="polite">0°</span>
                    </div>
                    <div class="flip-controls-container">
                        <label class="flip-checkbox-label">
                            <input type="checkbox" id="flip-horizontal-checkbox"
                                   aria-label="Flip layer horizontally">
                            <span class="checkbox-text" data-i18n="controls.flipHorizontal">좌우반전</span>
                        </label>
                    </div>
                </div>
                
                <!-- Color picker for layers with color property -->
                <div id="color-palette-container" class="color-display-container" style="display: none;">
                    <div class="color-display-wrapper">
                        <label class="color-display-label" for="current-color-display">Color:</label>
                        <button class="current-color-display" id="current-color-display"
                                aria-label="Open color picker"
                                aria-describedby="current-color-description">
                            <div class="current-color-swatch" id="current-color-swatch" aria-hidden="true"></div>
                            <span id="current-color-description" class="sr-only">Current color picker button</span>
                        </button>
                    </div>
                </div>
                
                <!-- Color picker dropdown -->
                <div id="color-picker-dropdown" class="color-picker-dropdown" role="dialog"
                     aria-label="Color Picker" aria-modal="true" tabindex="-1">
                    <div class="color-picker-content">
                        <button class="color-picker-close-btn" id="color-picker-close-btn"
                                aria-label="Close color picker">Close</button>
                        <div class="color-picker-main">
                            <div class="color-wheel-section">
                                <label for="color-wheel-canvas" class="sr-only">Color wheel - click or use arrow keys to select hue and saturation</label>
                                <canvas id="color-wheel-canvas" width="200" height="200"
                                        role="slider"
                                        aria-label="Color wheel for hue and saturation selection"
                                        tabindex="0"></canvas>
                                <div class="color-wheel-handle" id="color-wheel-handle" aria-hidden="true"></div>
                            </div>
                            <div class="brightness-section">
                                <label for="brightness-slider-track" class="sr-only">Brightness slider</label>
                                <div class="brightness-slider-container">
                                    <div class="brightness-slider-track" id="brightness-slider-track"
                                         role="slider"
                                         aria-label="Brightness level"
                                         aria-valuemin="0"
                                         aria-valuemax="100"
                                         aria-valuenow="50"
                                         tabindex="0">
                                        <div class="brightness-slider-handle" id="brightness-slider-handle" aria-hidden="true"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </section>
        </main>

        <aside class="property-panel" role="complementary" aria-label="Texture Editor Controls">
            <div class="panel-header">
                <h1 data-i18n="nav.textureEditor">텍스처 에디터</h1>
            </div>

            <section class="base-texture-section" aria-labelledby="base-texture-heading">
                <div class="texture-preset-controls">
                    <h3>Set Options</h3>
                    <div class="texture-preset-buttons">
                        <button id="short-shirt-set-btn" class="texture-preset-btn active" data-set-option="short-shirt-set">Short Shirt Set</button>
                        <button id="long-shirt-set-btn" class="texture-preset-btn" data-set-option="long-shirt-set">Long Shirt Set</button>
                        <button id="short-shirt-btn" class="texture-preset-btn" data-set-option="short-shirt">Short Shirt</button>
                        <button id="long-shirt-btn" class="texture-preset-btn" data-set-option="long-shirt">Long Shirt</button>
                        <button id="pants-btn" class="texture-preset-btn" data-set-option="pants">Pants</button>
                    </div>

                    <div class="divider"></div>

                    <div class="design-section">
                        <h4>Design</h4>
                        <div class="set-type-buttons">
                            <button id="setin-btn" class="set-type-btn" data-design-type="setin">Set-in</button>
                            <button id="regulan-btn" class="set-type-btn active" data-design-type="regulan">Regulan</button>
                        </div>

                        <div class="neck-section">
                            <h4>Necks</h4>
                            <div class="neck-buttons">
                                <button id="std-a-btn" class="neck-btn active" data-neck-type="std_a">Standard A</button>
                                <button id="std-b-btn" class="neck-btn" data-neck-type="std_b">Standard B</button>
                                <button id="cft-b-btn" class="neck-btn" data-neck-type="cft_b">Comfort B</button>
                                <button id="cft-c-btn" class="neck-btn" data-neck-type="cft_c">Comfort C</button>
                                <button id="cft-d-btn" class="neck-btn" data-neck-type="cft_d">Comfort D</button>
                            </div>
                        </div>

                        <div class="custom-pattern-section">
                            <h4>Custom Pattern</h4>
                            <div class="custom-pattern-buttons">
                                <button id="custom-1-2-btn" class="custom-pattern-btn" data-pattern="reg_custom-1-2" data-design-type="regulan">Custom-1-2</button>
                                <button id="custom-1-1-btn" class="custom-pattern-btn" data-pattern="setin_custom-1-1" data-design-type="setin">Custom-1-1</button>
                                <button id="custom-1-3-btn" class="custom-pattern-btn" data-pattern="setin_custom-1-3" data-design-type="setin">Custom-1-3</button>
                            </div>
                        </div>

                        <div class="custom-color-section">
                            <h4>Custom Color</h4>

                            <div class="color-group">
                                <h5>Pattern Colors</h5>
                                <div class="color-pickers">
                                    <!-- Pattern color pickers will be dynamically created here -->
                                </div>
                            </div>

                            <div class="color-group">
                                <h5>Body</h5>
                                <div class="color-pickers">
                                    <input type="color" id="body-color-1" class="custom-color-picker" value="#ffffff">
                                    <input type="color" id="body-color-2" class="custom-color-picker" value="#000000">
                                    <input type="color" id="body-color-3" class="custom-color-picker" value="#ff0000">
                                </div>
                            </div>

                            <div class="color-group">
                                <h5>Neck</h5>
                                <div class="color-pickers">
                                    <input type="color" id="neck-color-1" class="custom-color-picker" value="#ffffff">
                                    <input type="color" id="neck-color-2" class="custom-color-picker" value="#000000">
                                </div>
                            </div>

                            <div class="color-group">
                                <h5>Pants</h5>
                                <div class="color-pickers">
                                    <input type="color" id="pants-color-1" class="custom-color-picker" value="#ffffff">
                                    <input type="color" id="pants-color-2" class="custom-color-picker" value="#000000">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="layers-section" aria-labelledby="layers-heading">
                <div class="layers-header">
                    <h2 id="layers-heading" data-i18n="layers.title">레이어</h2>
                    <div class="layer-controls" role="group" data-i18n-aria="accessibility.addNewLayers" aria-label="새 레이어 추가">
                        <button id="add-text-btn" class="add-layer-btn"
                                data-i18n-aria="accessibility.addNewTextLayer" aria-label="새 텍스트 레이어 추가" data-i18n="layers.addText">텍스트 추가</button>
                        <button id="add-logo-btn" class="add-layer-btn"
                                data-i18n-aria="accessibility.addNewLogoLayer" aria-label="새 로고 레이어 추가" data-i18n="layers.addLogo">로고 추가</button>
                    </div>
                </div>
                <div id="layers-list" class="layers-list" role="list" data-i18n-aria="accessibility.textureLayersList" aria-label="텍스처 레이어 목록"></div>
            </section>

            <!-- Color picker dropdown for texture editor layers -->
            <div id="layer-color-picker-dropdown" class="color-picker-dropdown" role="dialog"
                 aria-label="Layer Color Picker" aria-modal="true" tabindex="-1">
                <div class="color-picker-content">
                    <button class="color-picker-close-btn" id="layer-color-picker-close-btn"
                            aria-label="Close layer color picker">Close</button>
                    <div class="color-picker-main">
                        <div class="color-wheel-section">
                            <label for="layer-color-wheel-canvas" class="sr-only">Layer color wheel - click or use arrow keys to select hue and saturation</label>
                            <canvas id="layer-color-wheel-canvas" width="200" height="200"
                                    role="slider"
                                    aria-label="Layer color wheel for hue and saturation selection"
                                    tabindex="0"></canvas>
                            <div class="color-wheel-handle" id="layer-color-wheel-handle" aria-hidden="true"></div>
                        </div>
                        <div class="brightness-section">
                            <label for="layer-brightness-slider-track" class="sr-only">Layer brightness slider</label>
                            <div class="brightness-slider-container">
                                <div class="brightness-slider-track" id="layer-brightness-slider-track"
                                     role="slider"
                                     aria-label="Layer brightness level"
                                     aria-valuemin="0"
                                     aria-valuemax="100"
                                     aria-valuenow="50"
                                     tabindex="0">
                                    <div class="brightness-slider-handle" id="layer-brightness-slider-handle" aria-hidden="true"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <section class="export-section" aria-labelledby="export-heading">
                <h2 id="export-heading" class="sr-only">Export and Order Actions</h2>
                <div class="action-controls" role="group" data-i18n-aria="accessibility.exportAndOrderActions" aria-label="내보내기 및 주문 작업">
                    <button id="order-btn" class="order-btn"
                            data-i18n-aria="accessibility.createOrderForm" aria-label="현재 구성으로 주문서 작성" data-i18n="nav.createOrder">주문서 작성</button>
                    <button id="submit-btn" class="submit-btn"
                            data-i18n-aria="accessibility.submitConfiguration" aria-label="현재 구성 제출" data-i18n="actions.submitOrder">주문 제출</button>
                </div>
            </section>
        </aside>
    </div>
    
    <!-- Order Form Modal -->
    <div id="order-modal" class="modal-overlay" style="display: none;"
         role="dialog" aria-modal="true" aria-labelledby="order-modal-title">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="order-modal-title" class="modal-title">Create Order Form</h2>
                <button class="modal-close-btn" id="order-modal-close"
                        aria-label="Close order form dialog">Close</button>
            </div>
            <div class="modal-body" role="document">
                <!-- Form will be dynamically populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Keyboard navigation help -->
    <div id="keyboard-help" class="keyboard-help">
        <h4>Keyboard Controls</h4>
        <ul>
            <li><kbd>Tab</kbd> Navigate between controls</li>
            <li><kbd>Arrow keys</kbd> Navigate 3D view/menus</li>
            <li><kbd>Enter/Space</kbd> Activate buttons</li>
            <li><kbd>Delete</kbd> Remove selected layer</li>
            <li><kbd>Ctrl+↑/↓</kbd> Reorder layers</li>
            <li><kbd>Ctrl+1-9</kbd> Select layer by number</li>
            <li><kbd>+/-</kbd> Zoom in 3D view</li>
            <li><kbd>Esc</kbd> Close dialogs/clear selection</li>
        </ul>
    </div>

    <script type="module" src="main.js"></script>
    <!-- Accessibility validation in development -->
    <script type="module" src="accessibility-validator.js"></script>
</body>
</html>